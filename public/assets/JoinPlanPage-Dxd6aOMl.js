import{r as u,ae as pe,b9 as te,z as q,C as a,I as ve,D as _,E as Q,ad as R,ac as b,ai as O,F as xe,B as be,aE as ye,bc as Pe,O as je,an as ne,am as re,L as K,V as oe,T as ke,Y as Ce,W as V,as as we}from"./index-D-3i0_ZZ.js";import{u as Se}from"./use-toast-TcS82ZOd.js";import{H as ce}from"./heading-BF8XlgKi.js";import{S as Re}from"./simple-grid-VxbnG-mh.js";import{b as Fe,F as W}from"./use-form-control-CBGUu0xk.js";import{t as De,v as We,s as Ge,F as G,S as se}from"./select-CWzTcnSc.js";import{I as Y}from"./input-CoPoFIUG.js";import"./grid-Cpr5m2qk.js";function Ie(o){return o&&te(o)&&te(o.target)}function Ne(o={}){const{onChange:e,value:l,defaultValue:h,name:f,isDisabled:p,isFocusable:C,isNative:g,...y}=o,[w,P]=u.useState(h||""),v=typeof l<"u",j=v?l:w,s=u.useRef(null),m=u.useCallback(()=>{const i=s.current;if(!i)return;let r="input:not(:disabled):checked";const S=i.querySelector(r);if(S){S.focus();return}r="input:not(:disabled)";const x=i.querySelector(r);x==null||x.focus()},[]),d=`radio-${u.useId()}`,D=f||d,F=u.useCallback(i=>{const r=Ie(i)?i.target.value:i;v||P(r),e==null||e(String(r))},[e,v]),n=u.useCallback((i={},r=null)=>({...i,ref:pe(r,s),role:"radiogroup"}),[]),t=u.useCallback((i={},r=null)=>({...i,ref:r,name:D,[g?"checked":"isChecked"]:j!=null?i.value===j:void 0,onChange(x){F(x)},"data-radiogroup":!0}),[g,D,F,j]);return{getRootProps:n,getRadioProps:t,name:D,ref:s,focus:m,setValue:P,value:j,onChange:F,isDisabled:p,isFocusable:C,htmlProps:y}}const[_e,ue]=ve({name:"RadioGroupContext",strict:!1}),de=q((o,e)=>{const{colorScheme:l,size:h,variant:f,children:p,className:C,isDisabled:g,isFocusable:y,...w}=o,{value:P,onChange:v,getRootProps:j,name:s,htmlProps:m}=Ne(w),k=u.useMemo(()=>({name:s,size:h,onChange:v,colorScheme:l,value:P,variant:f,isDisabled:g,isFocusable:y}),[s,h,v,l,P,f,g,y]);return a.jsx(_e,{value:k,children:a.jsx(_.div,{...j(m,e),className:Q("chakra-radio-group",C),children:p})})});de.displayName="RadioGroup";function Ae(o={}){const{defaultChecked:e,isChecked:l,isFocusable:h,isDisabled:f,isReadOnly:p,isRequired:C,onChange:g,isInvalid:y,name:w,value:P,id:v,"data-radiogroup":j,"aria-describedby":s,...m}=o,k=`radio-${u.useId()}`,d=Fe(),F=!!ue()||!!j;let t=!!d&&!F?d.id:k;t=v??t;const i=f??(d==null?void 0:d.isDisabled),r=p??(d==null?void 0:d.isReadOnly),S=C??(d==null?void 0:d.isRequired),x=y??(d==null?void 0:d.isInvalid),[A,T]=u.useState(!1),[M,H]=u.useState(!1),[U,L]=u.useState(!1),[he,me]=u.useState(!!e),z=typeof l<"u",I=z?l:he,J=u.useRef(!1);u.useEffect(()=>De(c=>{J.current=c}),[]);const X=u.useCallback(c=>{if(r||i){c.preventDefault();return}z||me(c.currentTarget.checked),g==null||g(c)},[z,i,r,g]),Z=u.useCallback(c=>{c.key===" "&&L(!0)},[L]),ee=u.useCallback(c=>{c.key===" "&&L(!1)},[L]),fe=u.useCallback((c={},N=null)=>({...c,ref:N,"data-active":b(U),"data-hover":b(M),"data-disabled":b(i),"data-invalid":b(x),"data-checked":b(I),"data-focus":b(A),"data-focus-visible":b(A&&J.current),"data-readonly":b(r),"aria-hidden":!0,onMouseDown:R(c.onMouseDown,()=>L(!0)),onMouseUp:R(c.onMouseUp,()=>L(!1)),onMouseEnter:R(c.onMouseEnter,()=>H(!0)),onMouseLeave:R(c.onMouseLeave,()=>H(!1))}),[U,M,i,x,I,A,r]),{onFocus:ae,onBlur:le}=d??{},ge=u.useCallback((c={},N=null)=>{const ie=i&&!h;return{...c,id:t,ref:N,type:"radio",name:w,value:P,onChange:R(c.onChange,X),onBlur:R(le,c.onBlur,()=>T(!1)),onFocus:R(ae,c.onFocus,()=>T(!0)),onKeyDown:R(c.onKeyDown,Z),onKeyUp:R(c.onKeyUp,ee),checked:I,disabled:ie,readOnly:r,required:S,"aria-invalid":O(x),"aria-disabled":O(ie),"aria-required":O(S),"data-readonly":b(r),"aria-describedby":s,style:We}},[i,h,t,w,P,X,le,ae,Z,ee,I,r,S,x,s]);return{state:{isInvalid:x,isFocused:A,isChecked:I,isActive:U,isHovered:M,isDisabled:i,isReadOnly:r,isRequired:S},getRadioProps:fe,getInputProps:ge,getLabelProps:(c={},N=null)=>({...c,ref:N,onMouseDown:R(c.onMouseDown,Le),"data-disabled":b(i),"data-checked":b(I),"data-invalid":b(x)}),getRootProps:(c,N=null)=>({htmlFor:t,...c,ref:N,"data-disabled":b(i),"data-checked":b(I),"data-invalid":b(x)}),htmlProps:m}}function Le(o){o.preventDefault(),o.stopPropagation()}const E=q((o,e)=>{const l=ue(),{onChange:h,value:f}=o,p=xe("Radio",{...l,...o}),C=be(o),{spacing:g="0.5rem",children:y,isDisabled:w=l==null?void 0:l.isDisabled,isFocusable:P=l==null?void 0:l.isFocusable,inputProps:v,...j}=C;let s=o.isChecked;(l==null?void 0:l.value)!=null&&f!=null&&(s=l.value===f);let m=h;l!=null&&l.onChange&&f!=null&&(m=ye(l.onChange,h));const k=(o==null?void 0:o.name)??(l==null?void 0:l.name),{getInputProps:d,getRadioProps:D,getLabelProps:F,getRootProps:n,htmlProps:t}=Ae({...j,isChecked:s,isFocusable:P,isDisabled:w,onChange:m,name:k}),[i,r]=Ge(t,Pe),S=D(r),x=d(v,e),A=F(),T=Object.assign({},i,n()),M={display:"inline-flex",alignItems:"center",verticalAlign:"top",cursor:"pointer",position:"relative",...p.container},H={display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,...p.control},U={userSelect:"none",marginStart:g,...p.label};return a.jsxs(_.label,{className:"chakra-radio",...T,__css:M,children:[a.jsx("input",{className:"chakra-radio__input",...x}),a.jsx(_.span,{className:"chakra-radio__control",...S,__css:H}),y&&a.jsx(_.span,{className:"chakra-radio__label",...A,__css:U,children:y})]})});E.displayName="Radio";const $=q(function(e,l){const{spacing:h="0.5rem",spacingX:f,spacingY:p,children:C,justify:g,direction:y,align:w,className:P,shouldWrapChildren:v,...j}=e,s=u.useMemo(()=>v?u.Children.map(C,(m,k)=>a.jsx(B,{children:m},k)):C,[C,v]);return a.jsx(_.div,{ref:l,className:Q("chakra-wrap",P),...j,children:a.jsx(_.ul,{className:"chakra-wrap__list",__css:{display:"flex",flexWrap:"wrap",justifyContent:g,alignItems:w,flexDirection:y,listStyleType:"none",gap:h,columnGap:f,rowGap:p,padding:"0"},children:s})})});$.displayName="Wrap";const B=q(function(e,l){const{className:h,...f}=e;return a.jsx(_.li,{ref:l,__css:{display:"flex",alignItems:"flex-start"},className:Q("chakra-wrap__listitem",h),...f})});B.displayName="WrapItem";const Ee=({onComplete:o})=>{const{t:e}=je(),{user:l,setUser:h,userPlan:f}=ne(),p=Se(),[C,g]=u.useState(!1),[y,w]=u.useState(null),P=re(),v=[{value:"vegetarian",label:e("premium.vegetarian")||"Vegetarian"},{value:"vegan",label:e("premium.vegan")||"Vegan"},{value:"pescatarian",label:e("premium.pescatarian")||"Pescatarian"},{value:"keto",label:e("premium.keto")||"Ketogenic"},{value:"paleo",label:e("premium.paleo")||"Paleo"},{value:"mediterranean",label:e("premium.mediterranean")||"Mediterranean"},{value:"low-carb",label:e("premium.lowCarb")||"Low Carb"},{value:"gluten-free",label:e("premium.glutenFree")||"Gluten Free"},{value:"dairy-free",label:e("premium.dairyFree")||"Dairy Free"},{value:"halal",label:e("premium.halal")||"Halal"},{value:"kosher",label:e("premium.kosher")||"Kosher"},{value:"none",label:e("premium.none")||"None"}],j=[{value:"nuts",label:e("premium.nuts")||"Nuts"},{value:"peanuts",label:e("premium.peanuts")||"Peanuts"},{value:"shellfish",label:e("premium.shellfish")||"Shellfish"},{value:"fish",label:e("premium.fish")||"Fish"},{value:"eggs",label:e("premium.eggs")||"Eggs"},{value:"milk",label:e("premium.milk")||"Milk/Dairy"},{value:"soy",label:e("premium.soy")||"Soy"},{value:"wheat",label:e("premium.wheat")||"Wheat"},{value:"sesame",label:e("premium.sesame")||"Sesame"},{value:"sulfites",label:e("premium.sulfites")||"Sulfites"},{value:"none",label:e("premium.none")||"None"}],[s,m]=u.useState({healthProfile:{dietaryPreferences:["none"],allergies:["none"],age:"",height:"",weight:"",gender:"",activityLevel:"moderately-active",fitnessGoal:"maintenance"}});u.useEffect(()=>{if(l&&l.healthProfile){const n={age:l.age!=null?l.age.toString():"",gender:l.gender||"",healthProfile:{dietaryPreferences:Array.isArray(l.healthProfile.dietaryPreferences)&&l.healthProfile.dietaryPreferences.length>0?l.healthProfile.dietaryPreferences:["none"],allergies:Array.isArray(l.healthProfile.allergies)&&l.healthProfile.allergies.length>0?l.healthProfile.allergies:["none"],height:l.healthProfile.height!=null?l.healthProfile.height.toString():"",weight:l.healthProfile.weight!=null?l.healthProfile.weight.toString():"",activityLevel:l.healthProfile.activityLevel||"moderately-active",fitnessGoal:l.healthProfile.fitnessGoal||"maintenance"}};m(n),console.log("Health profile initialized:",n)}},[l]);const k=n=>{const{name:t,value:i}=n.target;m(r=>({...r,[t]:i}))},d=n=>{if(n.includes("none"))m(t=>({...t,healthProfile:{...t.healthProfile,dietaryPreferences:["none"]}}));else{const t=n.filter(i=>i!=="none");m(i=>({...i,healthProfile:{...i.healthProfile,dietaryPreferences:t.length>0?t:["none"]}}))}},D=n=>{if(n.includes("none"))m(t=>({...t,healthProfile:{...t.healthProfile,allergies:["none"]}}));else{const t=n.filter(i=>i!=="none");m(i=>({...i,healthProfile:{...i.healthProfile,allergies:t.length>0?t:["none"]}}))}},F=async n=>{n.preventDefault(),g(!0),w(null);try{if(!(l!=null&&l.uid))throw new Error("User not authenticated");const t={age:s.age?parseInt(s.age,10):null,gender:s.gender||"",healthProfile:{dietaryPreferences:s.healthProfile.dietaryPreferences||["none"],allergies:s.healthProfile.allergies||["none"],height:s.healthProfile.height?parseInt(s.healthProfile.height,10):null,weight:s.healthProfile.weight?parseInt(s.healthProfile.weight,10):null,activityLevel:s.healthProfile.activityLevel||"moderately-active",fitnessGoal:s.healthProfile.fitnessGoal||"maintenance"}};console.log("Updating user profile with data:",t),await we(l.uid,t)&&h(r=>({...r,age:t.age,gender:t.gender,healthProfile:{...r.healthProfile,...t.healthProfile}})),p({title:e("profile.profileUpdated"),status:"success",duration:5e3,isClosable:!1}),o&&(P("/checkout-plan"),o())}catch(t){console.error("Error updating profile:",t),w(t.message||"Failed to update profile"),p({title:e("premium.error"),description:t.message||e("premium.errorUpdatingProfile"),status:"error",duration:5e3,isClosable:!1})}finally{g(!1)}};return a.jsx(K,{maxW:"800px",mx:"auto",mt:"8",p:"6",borderWidth:"1px",borderRadius:"lg",backgroundColor:"brand.100",children:a.jsx("form",{onSubmit:F,children:a.jsxs(oe,{spacing:"4",children:[a.jsx(ce,{as:"h2",size:"lg",mb:"4",children:e("premium.healthProfile")}),y&&a.jsx(K,{w:"full",p:"3",bg:"red.50",color:"red.600",borderRadius:"md",children:a.jsx(ke,{fontWeight:"medium",children:y})}),a.jsxs(Re,{columns:{base:1,md:2},spacing:"4",w:"full",children:[a.jsxs(W,{maxW:"90%",mx:8,children:[a.jsx(G,{children:e("premium.age")}),a.jsx(Y,{variant:"ghost",type:"number",name:"age",value:s.age,onChange:k,placeholder:e("premium.yourAge"),min:"10",max:"100",maxW:"90%"})]}),a.jsxs(W,{maxW:"90%",mx:8,children:[a.jsx(G,{children:e("premium.gender")}),a.jsxs(se,{name:"gender",value:s.gender||"",onChange:k,placeholder:e("premium.selectGender"),maxW:"95%",variant:"outline",px:3,mx:1,children:[a.jsx("option",{value:"male",children:e("premium.male")}),a.jsx("option",{value:"female",children:e("premium.female")}),a.jsx("option",{value:"other",children:e("premium.other")}),a.jsx("option",{value:"prefer-not-to-say",children:e("premium.preferNotToSay")})]})]}),a.jsxs(W,{maxW:"90%",mx:8,children:[a.jsx(G,{children:e("premium.heightCm")}),a.jsx(Y,{variant:"ghost",type:"number",name:"height",value:s.healthProfile.height,onChange:k,placeholder:e("premium.yourHeight"),min:"100",max:"250",maxW:"90%",backgroundColor:"white"})]}),a.jsxs(W,{maxW:"90%",mx:8,children:[a.jsx(G,{children:e("premium.weightKg")}),a.jsx(Y,{variant:"ghost",type:"number",name:"weight",value:s.healthProfile.weight,onChange:k,placeholder:e("premium.yourWeight"),min:"30",max:"200",maxW:"90%",backgroundColor:"white"})]})]}),a.jsxs(W,{maxW:"90%",mx:8,children:[a.jsx(G,{children:e("premium.activityLevel")}),a.jsx(de,{value:s.healthProfile.activityLevel||"moderately-active",onChange:n=>m(t=>({...t,healthProfile:{...t.healthProfile,activityLevel:n}})),children:a.jsxs(Ce,{direction:"column",children:[a.jsx(E,{value:"sedentary",children:e("premium.sedentary")}),a.jsx(E,{value:"lightly-active",children:e("premium.lightlyActive")}),a.jsx(E,{value:"moderately-active",children:e("premium.moderatelyActive")}),a.jsx(E,{value:"very-active",children:e("premium.veryActive")}),a.jsx(E,{value:"extremely-active",children:e("premium.extremelyActive")})]})})]}),a.jsxs(W,{maxW:"90%",mx:8,children:[a.jsx(G,{children:e("premium.fitnessGoal")}),a.jsxs(se,{name:"fitnessGoal",value:s.healthProfile.fitnessGoal||"maintenance",onChange:k,placeholder:e("premium.selectFitnessGoal"),children:[a.jsx("option",{value:"weight-loss",children:e("premium.weightLoss")}),a.jsx("option",{value:"weight-gain",children:e("premium.weightGain")}),a.jsx("option",{value:"maintenance",children:e("premium.maintenance")}),a.jsx("option",{value:"muscle-gain",children:e("premium.muscleGain")}),a.jsx("option",{value:"improve-fitness",children:e("premium.improveFitness")})]})]}),a.jsxs(W,{maxW:"90%",mx:8,children:[a.jsx(G,{children:e("premium.dietaryPreferences")}),a.jsx($,{spacing:3,children:v.map(n=>a.jsx(B,{children:a.jsx(V,{size:"sm",variant:s.healthProfile.dietaryPreferences.includes(n.value)?"solid":"outline",colorScheme:s.healthProfile.dietaryPreferences.includes(n.value)?"brand":"gray",onClick:()=>{const t=s.healthProfile.dietaryPreferences;let i;n.value==="none"?i=t.includes("none")?[]:["none"]:t.includes(n.value)?i=t.filter(r=>r!==n.value):i=[...t.filter(r=>r!=="none"),n.value],i.length===0&&(i=["none"]),d(i)},children:n.label})},n.value))})]}),a.jsxs(W,{maxW:"90%",mx:8,children:[a.jsx(G,{children:e("premium.allergies")}),a.jsx($,{spacing:3,children:j.map(n=>a.jsx(B,{children:a.jsx(V,{size:"sm",variant:s.healthProfile.allergies.includes(n.value)?"solid":"outline",colorScheme:s.healthProfile.allergies.includes(n.value)?"red":"gray",onClick:()=>{const t=s.healthProfile.allergies;let i;n.value==="none"?i=t.includes("none")?[]:["none"]:t.includes(n.value)?i=t.filter(r=>r!==n.value):i=[...t.filter(r=>r!=="none"),n.value],i.length===0&&(i=["none"]),D(i)},children:n.label})},n.value))})]}),a.jsx(V,{type:"submit",colorScheme:"brand",width:"full",mt:"4",isLoading:C,loadingText:e("premium.saving"),children:e("premium.saveHealthProfile")})]})})})},$e=()=>{const o=re(),{userPlan:e}=ne(),[l,h]=u.useState(0),f=()=>{h(1)},p=()=>{o("/premium")};return a.jsx(K,{p:{base:4,md:8},minH:"100vh",children:a.jsx(oe,{spacing:8,align:"stretch",children:l===0?a.jsx(Ee,{onComplete:f}):a.jsxs(K,{bg:"white",p:6,borderRadius:"md",shadow:"md",children:[a.jsx(ce,{as:"h2",size:"md",mb:4,children:"Confirm Your Subscription"}),a.jsxs(Text,{mb:4,children:["You're about to subscribe to: ",e==null?void 0:e.title]}),a.jsx(Text,{mb:6,children:"Please review your information before proceeding to payment."}),a.jsx(V,{colorScheme:"brand",size:"lg",width:"full",onClick:()=>o("/checkout"),children:"Proceed to Payment"}),a.jsx(V,{mt:4,variant:"outline",width:"full",onClick:p,children:"Back to Plans"})]})})})};export{$e as default};
